<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Isegzidrafok</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #000;
  color: azure;
  margin: 0;
  padding: 0;
}
.hidden { display: none; }
button {
  background-color: #222;
  color: azure;
  border: none;
  padding: 10px;
  margin: 5px;
  cursor: pointer;
}
button:hover {
  background-color: #444;
}
.container {
  padding: 15px;
}
.menu {
  display: flex;
  justify-content: space-around;
  background-color: #111;
  padding: 10px 0;
  position: sticky;
  top: 0;
}
.chat-list, .chat-window {
  border: 1px solid #444;
  margin-top: 10px;
  padding: 10px;
  height: 300px;
  overflow-y: auto;
  background-color: #111;
}
.message-input {
  display: flex;
  position: sticky;
  bottom: 0;
  background-color: #111;
}
.message-input input {
  flex: 1;
  padding: 10px;
  border: none;
  background-color: #222;
  color: azure;
}
.message-input button {
  padding: 10px;
}
.message {
  max-width: 70%;
  margin: 5px;
  padding: 8px;
  border-radius: 5px;
  position: relative;
}
.message .meta {
  font-size: 10px;
  position: absolute;
  bottom: -12px;
  right: 5px;
}
.message .sender {
  font-size: 10px;
  position: absolute;
  top: -12px;
  left: 5px;
}
.own {
  background-color: #3399ff;
  color: black;
  align-self: flex-end;
}
.other {
  background-color: #555;
  color: azure;
  align-self: flex-start;
}
.chat-window {
  display: flex;
  flex-direction: column;
}
</style>
</head>
<body>

<div id="loginScreen" class="container">
  <h2>Isegzidrafok</h2>
  <button onclick="showCreateAccount()">Yeni Hesap Oluştur</button>
  <button onclick="showLogin()">Hesaba Giriş Yap</button>
  <button onclick="showAdminLogin()">Yönetici Girişi</button>
</div>

<div id="createAccountScreen" class="container hidden">
  <h3>Yeni Hesap Oluştur</h3>
  İsim: <input type="text" id="newName"><br>
  Şifre: <input type="password" id="newPass"><br>
  <button onclick="createAccount()">Oluştur</button>
  <button onclick="backToLogin()">Geri</button>
</div>

<div id="loginAccountScreen" class="container hidden">
  <h3>Hesaba Giriş</h3>
  İsim: <input type="text" id="loginName"><br>
  Şifre: <input type="password" id="loginPass"><br>
  <button onclick="loginAccount()">Giriş</button>
  <button onclick="backToLogin()">Geri</button>
</div>

<div id="adminLoginScreen" class="container hidden">
  <h3>Yönetici Girişi</h3>
  Şifre: <input type="password" id="adminPass"><br>
  <button onclick="loginAdmin()">Giriş</button>
  <button onclick="backToLogin()">Geri</button>
</div>

<div id="adminPanel" class="container hidden">
  <h2>Yönetici Paneli</h2>
  <div id="pendingAccounts"></div>
  <div id="messagesToAdmin"></div>
  <button onclick="backToLogin()">Çıkış</button>
</div>

<div id="userPanel" class="container hidden">
  <div class="menu">
    <button onclick="showChats()">Sohbetler</button>
    <button onclick="showGroup()">Grup Sohbeti</button>
    <button onclick="showSettings()">Ayarlar</button>
  </div>
  <div id="chatListScreen" class="container">
    <h3>Sohbetler</h3>
    <div id="chatList" class="chat-list"></div>
    <input type="text" id="newChatName" placeholder="Yeni sohbet ismi">
    <button onclick="createChat()">Oluştur</button>
  </div>
  <div id="chatWindowScreen" class="container hidden">
    <h3 id="chatTitle"></h3>
    <div id="chatWindow" class="chat-window"></div>
    <div class="message-input">
      <input type="text" id="chatMessage" placeholder="Mesaj yaz...">
      <button onclick="sendMessage()">Gönder</button>
    </div>
  </div>
  <div id="groupChatScreen" class="container hidden">
    <h3>Grup Sohbeti</h3>
    <div id="groupWindow" class="chat-window"></div>
    <div class="message-input">
      <input type="text" id="groupMessage" placeholder="Mesaj yaz...">
      <button onclick="sendGroupMessage()">Gönder</button>
    </div>
  </div>
  <div id="settingsScreen" class="container hidden">
    <h3>Ayarlar</h3>
    <button onclick="toggleTheme()">Tema Değiştir (Koyu/Açık)</button>
    <button onclick="logout()">Çıkış Yap</button>
  </div>
</div>

<script>
let currentUser = null;
let currentChat = null;
let theme = 'dark';
let users = JSON.parse(localStorage.getItem('users') || '{}');
let chats = JSON.parse(localStorage.getItem('chats') || '{}');
let groupMessages = JSON.parse(localStorage.getItem('groupMessages') || '[]');

function saveData() {
  localStorage.setItem('users', JSON.stringify(users));
  localStorage.setItem('chats', JSON.stringify(chats));
  localStorage.setItem('groupMessages', JSON.stringify(groupMessages));
}

function showCreateAccount() {
  document.getElementById('loginScreen').classList.add('hidden');
  document.getElementById('createAccountScreen').classList.remove('hidden');
}
function showLogin() {
  document.getElementById('loginScreen').classList.add('hidden');
  document.getElementById('loginAccountScreen').classList.remove('hidden');
}
function showAdminLogin() {
  document.getElementById('loginScreen').classList.add('hidden');
  document.getElementById('adminLoginScreen').classList.remove('hidden');
}
function backToLogin() {
  document.querySelectorAll('.container').forEach(div => div.classList.add('hidden'));
  document.getElementById('loginScreen').classList.remove('hidden');
}
function createAccount() {
  let name = document.getElementById('newName').value;
  let pass = document.getElementById('newPass').value;
  if (!name || !pass) { alert('Boş bırakmayın'); return; }
  if (users[name]) { alert('Bu isim zaten var'); return; }
  users[name] = {pass: pass};
  saveData();
  alert('Hesap oluşturuldu');
  backToLogin();
}
function loginAccount() {
  let name = document.getElementById('loginName').value;
  let pass = document.getElementById('loginPass').value;
  if (users[name] && users[name].pass === pass) {
    currentUser = name;
    document.getElementById('loginAccountScreen').classList.add('hidden');
    document.getElementById('userPanel').classList.remove('hidden');
    showChats();
  } else { alert('Hatalı giriş'); }
}
function loginAdmin() {
  let pass = document.getElementById('adminPass').value;
  if (pass === 'aSDBnm1234562') {
    document.getElementById('adminLoginScreen').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
  } else { alert('Yanlış şifre'); }
}
function showChats() {
  document.getElementById('chatListScreen').classList.remove('hidden');
  document.getElementById('chatWindowScreen').classList.add('hidden');
  document.getElementById('groupChatScreen').classList.add('hidden');
  document.getElementById('settingsScreen').classList.add('hidden');
  let list = document.getElementById('chatList');
  list.innerHTML = '';
  if (chats[currentUser]) {
    Object.keys(chats[currentUser]).forEach(friend => {
      let btn = document.createElement('button');
      btn.textContent = friend;
      btn.onclick = () => openChat(friend);
      list.appendChild(btn);
    });
  }
}
function createChat() {
  let friend = document.getElementById('newChatName').value;
  if (!friend) return;
  if (!chats[currentUser]) chats[currentUser] = {};
  if (!chats[friend]) chats[friend] = {};
  chats[currentUser][friend] = chats[currentUser][friend] || [];
  chats[friend][currentUser] = chats[friend][currentUser] || [];
  saveData();
  showChats();
}
function openChat(friend) {
  currentChat = friend;
  document.getElementById('chatTitle').textContent = friend;
  document.getElementById('chatListScreen').classList.add('hidden');
  document.getElementById('chatWindowScreen').classList.remove('hidden');
  renderChat();
}
function renderChat() {
  let win = document.getElementById('chatWindow');
  win.innerHTML = '';
  let msgs = chats[currentUser][currentChat] || [];
  msgs.forEach(m => {
    let div = document.createElement('div');
    div.classList.add('message', m.sender === currentUser ? 'own' : 'other');
    div.innerHTML = `<div class="sender">${m.sender}</div>${m.text}<div class="meta">${m.time}</div>`;
    win.appendChild(div);
  });
}
function sendMessage() {
  let txt = document.getElementById('chatMessage').value;
  if (!txt) return;
  let time = formatDate();
  chats[currentUser][currentChat].push({sender: currentUser, text: txt, time});
  chats[currentChat][currentUser].push({sender: currentUser, text: txt, time});
  saveData();
  document.getElementById('chatMessage').value = '';
  renderChat();
}
function showGroup() {
  document.getElementById('chatListScreen').classList.add('hidden');
  document.getElementById('chatWindowScreen').classList.add('hidden');
  document.getElementById('groupChatScreen').classList.remove('hidden');
  document.getElementById('settingsScreen').classList.add('hidden');
  renderGroup();
}
function renderGroup() {
  let win = document.getElementById('groupWindow');
  win.innerHTML = '';
  groupMessages.forEach(m => {
    let div = document.createElement('div');
    div.classList.add('message', m.sender === currentUser ? 'own' : 'other');
    div.innerHTML = `<div class="sender">${m.sender}</div>${m.text}<div class="meta">${m.time}</div>`;
    win.appendChild(div);
  });
}
function sendGroupMessage() {
  let txt = document.getElementById('groupMessage').value;
  if (!txt) return;
  let time = formatDate();
  groupMessages.push({sender: currentUser, text: txt, time});
  saveData();
  document.getElementById('groupMessage').value = '';
  renderGroup();
}
function showSettings() {
  document.getElementById('chatListScreen').classList.add('hidden');
  document.getElementById('chatWindowScreen').classList.add('hidden');
  document.getElementById('groupChatScreen').classList.add('hidden');
  document.getElementById('settingsScreen').classList.remove('hidden');
}
function logout() {
  currentUser = null;
  backToLogin();
}
function toggleTheme() {
  if (theme === 'dark') {
    document.body.style.backgroundColor = '#fff';
    document.body.style.color = '#000';
    theme = 'light';
  } else {
    document.body.style.backgroundColor = '#000';
    document.body.style.color = 'azure';
    theme = 'dark';
  }
}
function formatDate() {
  let d = new Date();
  return `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}/${String(d.getHours()).padStart(2,'0')}/${String(d.getMinutes()).padStart(2,'0')}`;
}
</script>
</body>
      </html>
    
